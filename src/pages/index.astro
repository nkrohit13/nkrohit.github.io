---
import { getCollection } from 'astro:content';
import Hero from '../components/Hero.astro';
import ProjectPreview from '../components/ProjectPreview.astro';
import siteConfig from '../data/site-config';
import BaseLayout from '../layouts/BaseLayout.astro';
import { sortItemsByDateDesc } from '../utils/data-utils';

const { description, image } = siteConfig;

const projects = await getCollection('projects');
const latestProjects = projects.sort(sortItemsByDateDesc).slice(0, 2);
---

<BaseLayout description={description} image={image}>
    <Hero />
    {
        latestProjects.length > 0 ? (
            <div class="mb-16 sm:mb-24">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    {latestProjects.map((project) => (
                        <ProjectPreview project={project} showThumbnail={true} headingLevel="h3" />
                    ))}
                </div>
                <div class="mt-8 text-center">
                    <a
                        href="/projects"
                        class="inline-block px-6 py-2 text-base font-medium text-gray-900 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50"
                    >
                        View all projects <span aria-hidden="true">â†’</span>
                    </a>
                </div>
            </div>
        ) : (
            <p class="text-center text-gray-600">No projects available at the moment.</p>
        )
    }
</BaseLayout>
